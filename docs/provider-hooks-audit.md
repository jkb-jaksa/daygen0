# Provider hook audit

The table below captures the current public API and implementation gaps for each generation provider hook in `src/hooks/`. Signatures are taken from the exported interfaces in each file and note where behavior is still stubbed.

| Hook | Exported options | Exported state | Returned helpers | Current implementation notes |
| --- | --- | --- | --- | --- |
| `useFluxImageGeneration` | `FluxImageGenerationOptions` (`prompt`, `model`, optional width/height/aspect refs, references, avatar/product ids) | `FluxImageGenerationState` (`isLoading`, `error`, `generatedImage`, `jobStatus`, `progress`) | `generateImage`, `clearError`, `clearGeneratedImage`, `reset` | Uses `runGenerationJob` + `useGenerationJobTracker`; standardized progress updates; provider payload still assembled locally (TODO: share builder + confirm webhook handling). |
| `useGeminiImageGeneration` | `ImageGenerationOptions` (prompt, optional model/image data/references, temperature/outputLength/topP/aspect ratio, avatar/product/style ids, callbacks) | `ImageGenerationState` (`isLoading`, `error`, `generatedImage`, `progress`, `status`, `jobId`) | `generateImage`, `setError`, `reset`, credit modal helpers | `runGenerationJob` drives lifecycle and tracker updates; custom fallback/progress controller remains bespoke; TODO: consolidate payload shaping + preview fallback story. |
| `useLumaImageGeneration` | `LumaImageGenerationOptions` (`prompt`, `model`, aspect ratio + reference fields, format, callback URL, avatarId`) | Internal state with `generationId`, `status`, `contentType` | `generateImage`, `clearError`, `clearGeneratedImage`, `reset` | Migrated to `runGenerationJob` with tracker + normalized progress; still inlines provider payload + TODO for callback URL + format typing. |
| `useRunwayImageGeneration` | `ImageGenerationOptions` (`prompt`, `model`, `uiModel`, references, ratio, seed, avatar/product/style ids`) | `ImageGenerationState` | `generateImage`, `clearError`, `clearImage` plus credit modal helpers | Uses `runGenerationJob` / tracker and shared error resolver; TODO: dedupe provider option mapping + align `uiModel` vs `model` semantics. |
| `useChatGPTImageGeneration` | `ChatGPTImageGenerationOptions` (`prompt`, `n`, `size`, `quality`, `background`, avatar/product/style ids`) | `ChatGPTImageGenerationState` | `generateImage`, `clearError`, `clearGeneratedImage`, `reset` | `runGenerationJob` with tracker + immediate payload parsing; TODO: finish providerOptions normalization + background enum coverage. |
| `useIdeogramImageGeneration` | `IdeogramImageGenerationOptions` (`prompt`, `model`, `style`, `negativePrompt`, `ratio`, `avatarId`, `references`) | `IdeogramImageGenerationState` (`jobStatus`, `progress`, etc.) | `generateImage`, `clearError`, `clearGeneratedImage`, `reset` | Hooks into `runGenerationJob` and tracker updates; provider-specific metadata parsing still duplicated (TODO: centralize parse helper + validate style catalog). |
| `useReveImageGeneration` | `ReveImageGenerationOptions` (`prompt`, `style`, `ratio`, `references`, avatar/product/style ids) | `ReveImageGenerationState` | `generateImage`, `clearError`, `clearGeneratedImage`, `reset` | `runGenerationJob` + tracker for lifecycle; TODO: consolidate ratio/style payload + confirm webhook/owner metadata. |
| `useQwenImageGeneration` | `QwenImageGenerationOptions` (`prompt`, `model`, `size`, `negativePrompt`, `watermark`, `avatarId`, etc.) | `QwenImageGenerationState` (`isLoading`, `error`, `generatedImage`, `jobStatus`, `progress`) | `generateImage`, `clearError`, `clearGeneratedImage`, `reset` | `runGenerationJob` integration complete; TODO: normalize providerOptions builder + document watermark flag contract. |
| `useLumaVideoGeneration` | `LumaVideoGenerationOptions` (`prompt`, `style`, `referenceImages`, `callbackUrl`, etc.) | `LumaVideoGenerationState` (tracks `jobId`, `status`, `progress`) | `generateVideo`, `clearError`, `reset` | `runGenerationJob` and tracker unify polling; TODO: share media-specific parser + validate callback URL plumbing. |
| `useRunwayVideoGeneration` | `RunwayVideoGenerationOptions` (`prompt`, `duration`, `aspectRatio`, `motion`, etc.) | `RunwayVideoGenerationState` (`isGenerating`, `error`, `jobId`, `status`, `resultUrl`) | `generateVideo`, `clearError`, `reset` | Uses `runGenerationJob` + tracker with consistent progress; TODO: reconcile duration/motion providerOptions + finalize result normalization. |
| `useHailuoVideoGeneration` | `HailuoVideoGenerationOptions` (`prompt`, `model`, `ratio`, `references`) | `HailuoVideoGenerationState` | `generateVideo`, `clearError`, `reset` | Migrated to `runGenerationJob` and tracker; TODO: tighten providerOptions builder (ratio defaults) + ensure reference upload path. |
| `useKlingVideoGeneration` | `KlingVideoGenerationOptions` (`prompt`, `style`, `aspectRatio`, `guidanceScale`, references) | `KlingVideoGenerationState` | `generateVideo`, `clearError`, `reset` | `runGenerationJob` standardizes polling + tracker; TODO: finish payload normalization (guidance defaults, motion controls) + parse multi-asset response. |
| `useSeedanceVideoGeneration` | `SeedanceVideoGenerationOptions` (`prompt`, `ratio`, `style`, `references`) | `SeedanceVideoGenerationState` | `generateVideo`, `clearError`, `reset` | Uses `runGenerationJob` and tracker (with immediate + job parsing); TODO: extract providerOptions builder + align file-to-base64 helper ownership. |
| `useVeoVideoGeneration` | `VeoVideoGenerationOptions` (`prompt`, `model`, `aspectRatio`, `duration`, references) | `VeoVideoGenerationState` | `generateVideo`, `clearError`, `reset` | `runGenerationJob` & tracker integration landed; TODO: finalize duration validation + ensure response metadata normalization (thumbnails, fps). |
| `useWanVideoGeneration` | `WanVideoGenerationOptions` (`prompt`, `size`, `seed`, `negativePrompt`, `watermark`, references) | `WanVideoGenerationState` | `generateVideo`, `clearError`, `reset` | Shares `runGenerationJob` + tracker; TODO: centralize providerOptions (watermark/seed) + confirm localization of progress strings. |

These updates confirm that every provider hook now calls `runGenerationJob` and feeds lifecycle updates into `useGenerationJobTracker`. Remaining gaps mostly revolve around consolidating provider-specific payload builders, double-checking metadata normalization, and documenting webhook/owner fields per provider.

## Divergence callouts

- **Gemini** retains a bespoke fallback flow (`preview` retry + custom progress controller) that still needs unification with the shared tracker pipeline.
- **ChatGPT** is the only hook leaning on immediate responses today; confirm the TODOs for background enum + providerOptions once backend settles.
- **Seedance** continues to inline file-to-base64 conversions for first/last-frame uploads; this should migrate into a shared helper to keep the hook thin.

## Changelog

- Documented `runGenerationJob` coverage across hooks and the shared tracker guarantees validated by `generationJobHelpers.test.ts` (polling, lifecycle tracking, abort behavior).
